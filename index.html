<!DOCTYPE html>
<html lang="en">
<!-- 
   Team Members: Guilherme Forssetto, Jacques Ehrardt and Pedro Soares.
 -->

<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Sudoku</title>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
</head>
<style>
   td {
      border: solid 1px;
      padding: 15px;
   }

   table {
      border-collapse: collapse;
      font-size: 25px;
      display: flex;
      flex-direction: column;
      align-items: center;
   }
</style>

<body>
   <table>

   </table>
</body>
<script>
   let sudokuCol = [[],[],[],[],[],[],[],[],[]];
   let cubs = [[],[],[],[],[],[],[],[],[]];
   let sudoku = null;
   let sudokuReady = null;
   let addBtn = $("<button>Add Sudoku</button>");
   let valBtn = $("<button>Validate</button>");
   let table = $("table");
   let body = $("body");
   $.getJSON("http://127.0.0.1:5501/data/source.json", (values) => {
      values.forEach((number) => {
         sudoku = number.values;
      })
   })

   let check = (inputArray)=>{
      let sum = 0;
      for(let item of inputArray){
         sum += item;
      }
      if(sum != 45){
         return true;
      }
      else{
         return false;
      }
   }

   let checkRow = (inputArray)=>{
      for(let row of inputArray){
         if(check(row) == true){
            return true;
            break;
         }
      }
      return false;
   }

   let checkCol = (inputArray)=>{
      for(let row of inputArray) {
         for(let idxCol in row){
            sudokuCol[idxCol].push(row[idxCol]);
         }
      };
      return checkRow(sudokuCol);
   }

   let checkCubes = (inputArray)=>{
      for(let i in inputArray){
         if(i < 3){
            for(let x in inputArray[i]){
               if(x < 3){
                  cubs[0].push(inputArray[i][x]);
               }
               else if(x >= 3 && x < 6){
                  cubs[1].push(inputArray[i][x]);
               }
               else{
                  cubs[2].push(inputArray[i][x]);
               }
            }
         }
         else if(i >= 3 && i < 6){
            for(let x in inputArray[i]){
               if(x < 3){
                  cubs[3].push(inputArray[i][x]);
               }
               else if(x >= 3 && x < 6){
                  cubs[4].push(inputArray[i][x]);
               }
               else{
                  cubs[5].push(inputArray[i][x]);
               }
            }
         }
         else{
            for(let x in inputArray[i]){
               if(x < 3){
                  cubs[6].push(inputArray[i][x]);
               }
               else if(x >= 3 && x < 6){
                  cubs[7].push(inputArray[i][x]);
               }
               else{
                  cubs[8].push(inputArray[i][x]);
               }
            }
         }
      }
      return checkRow(cubs);
   }
   
   let checkSudoku = (inputArray)=>{
   sudokuCol = [[],[],[],[],[],[],[],[],[]];
   cubs = [[],[],[],[],[],[],[],[],[]];
      if(checkRow(inputArray)){
         alert("Your sudoku is wrong!");
      }
      else if(checkCol(inputArray)){
         alert("Your sudoku is wrong!");
      }
      else if(checkCubes(inputArray)){
         alert("Your sudoku is wrong!");
      }
      else{
         alert("Your sudoku is right!");
      }
   }

   let addTable = () => {
      $("table").empty();
      for (let row of sudoku) {
         let tr = $("<tr></tr>");
         for (let val of row) {
            let td = $("<td></td>");
            td.append(val);
            tr.append(td);
         }
         table.append(tr);
      }

   }

   let call = () => {
      sudokuReady = [];
      let counter = 0;
      for (let i = 0; i < 9; i++) {
         let sRow = new Array()
         for (let i = 0; i < 9; i++) {
            sRow.push(parseInt($('td').eq(counter++).text()))
         }
         sudokuReady.push(sRow);
      }
      checkSudoku(sudokuReady);
      // console.log(sudokuReady)
   }

   addBtn.click(addTable);
   valBtn.click(call);
   body.prepend(addBtn, valBtn);
</script>

</html>